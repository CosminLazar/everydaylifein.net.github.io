---
layout: post
title: Running PowerShell scripts during NuGet package installation and removal
date: 2015-02-21 21:46:54.000000000 +00:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- ".NET"
tags:
- nuget
- powershell
meta:
  _edit_last: '1'
  _publicize_facebook_user: https://www.facebook.com/lazarconstantincosmin
  _publicize_twitter_user: "@CosminLazar"
  _yoast_wpseo_focuskw: PowerShell in NuGet
  _yoast_wpseo_metadesc: How to execute PowerShell scripts when installing/removing
    NuGet packages
  _yoast_wpseo_linkdex: '52'
  _yoast_wpseo_title: Running PowerShell scripts during NuGet package installation/removal
  _wpas_done_all: '1'
  _wpas_skip_5526398: '1'
  _wpas_skip_5526404: '1'
  _wpas_skip_6755022: '1'
  _wpas_skip_7497947: '1'
  _yoast_wpseo_focuskw_text_input: PowerShell in NuGet
  _yoast_wpseo_content_score: '30'
  _yoast_wpseo_primary_category: ''
author:
  login: admin
  email: cosminconstantinlazar@gmail.com
  display_name: Cosmin Lazar
  first_name: Cosmin
  last_name: Lazar
permalink: "/netframework/running-powershell-scripts-during-nuget-package-installation-and-removal.html"
excerpt: How to execute PowerShell scripts when installing/removing NuGet packages
---
<p>Your NuGet package can contain PowerShell scripts which, based on a convention, will be called during the package installation/removal process.</p>
<ul>
<li><strong><em>Init.ps1 </em></strong>runs the first time a package is installed in a solution</li>
<li><strong><em>Install.ps1 </em></strong>runs when a package is installed in a project &lt;- no longer supported in Visual Studio 2017 (<a href="http://blog.nuget.org/20170316/NuGet-now-fully-integrated-into-MSBuild.html">read more</a>)</li>
<li><strong><em>Uninstall.ps1 </em></strong>runs every time a package is uninstalled &lt;- no longer supported in Visual Studio 2017 (<a href="http://blog.nuget.org/20170316/NuGet-now-fully-integrated-into-MSBuild.html">read more</a>)</li>
<li><em>you can read more about it <a title="Creating Nuget packages - official documentation" href="https://docs.nuget.org/create/creating-and-publishing-a-package" target="_blank" rel="noopener">here</a></em></li>
</ul>
<p>Your scripts should begin with the following line</p>
<pre lang="powershell">param($installPath, $toolsPath, $package, $project)</pre>
<p>Where</p>
<ul>
<li><em><strong>$installPath</strong></em> path to where the project is installed</li>
<li><em><strong>$toolsPath</strong></em> path to the extracted tools directory</li>
<li><em><strong>$package</strong></em> information about the currently installing package</li>
<li><em><strong>$project</strong></em> reference to the <a title="EnvDTE - official msdn documentation" href="https://msdn.microsoft.com/en-us/library/envdte.dte.aspx" target="_blank" rel="noopener">EnvDTE </a>project the package is being installed into</li>
</ul>
<p>In order to be executed, the scripts need to be included in the tools directory of the nuget package. You can achieve this by editing your *.nuspec file and adding a file reference.</p>
<pre lang="xml">&lt;?xml version="1.0"?&gt;
&lt;package &gt;
  &lt;metadata&gt;...&lt;/metadata&gt;
  &lt;files&gt;
	&lt;file src="scripts\NugetScripts\Install.ps1" target="<strong>tools</strong>\Install.ps1" /&gt;
  &lt;/files&gt;
&lt;/package&gt;
</pre>
<p>You will quickly find debugging to be fairly painful if you need to operate with the $project reference. In this case, you are highly encouraged to test all your $project actions in the Visual Studio Package Manager Console by writing</p>
<pre lang="powershell">$project = Get-Project
</pre>
<p>Now you can interactively test your operations in the console, and you don't have to constantly pack and install/uninstall your package to check if the scripts work as intended.</p>
